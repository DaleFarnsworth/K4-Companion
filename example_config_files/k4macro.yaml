---

# server options:
#   name: The name of the server
#   type: The type of the server
#     k4 is required for k4 servers to receive responses
#   address: The ip address of the server
#   port: The port to connect to
#   startup: command(s) to be sent to the server on startup.

# page options:
#   name: The page name (required).
#     The page named 'main' is the first one displayed.
#   server: The default server items contained in this page will use
#   columns: The number of columns in which contained items will be displayed.
#   contains: The list of items this page contains

# group options:
#   label: The label that will be displayed for this group.
#   server: The default server items contained in this group will use
#   row: The row of the container in which this group will be placed.
#   column: The column of the container in which this group will be placed.
#   rowspan: The number of rows this group will occupy.
#   columnspan: The number of columns this group will occupy.
#   columns: The number of columns in which contained items will be displayed.
#   contains: The list of items this group contains

# button options:
#   text: button text
#   server: The server name of the server referenced by this button
#   cmd: Either:
#     a text string to be sent to k4, or
#     a python 'list' object containg server name/cmd pairs (python dict objects)
#     to be sent, i.e. [ k4: k4cmd, s1: s1cmd ] would send 'k4cmd' to server k4, and
#     then send 's1cmd' to server s1.
#   directive:
#     'quit', terminates the program
#     'show_previous_page', displays the previously-displayed page
#     'show_page XXX', displays page with the name: XXX
#   fg: foreground color
#   bg: background color
#   abg: active background color
#   justify: 'left', 'right', 'center' to justify text within the Button

# cyclebutton options:
#   wraparound: true or false. whether the button wraps back around to the first selection
#   updown: true or false, if true, selections cycle up if the button is clicked in its upper half
#       and selections cycle down if the button is clicked in its lower half
#   selections: a list of selections, each of which may have the following elements
#       text: button text
#       server: The server name of the server referenced by this button
#       cmd: Either:
#         a text string to be sent to k4, or
#         a python 'list' object containg server name/cmd pairs (python dict objects)
#         to be sent, i.e. [ k4: k4cmd, s1: s1cmd ] would send 'k4cmd' to server k4, and
#         then send 's1cmd' to server s1.
#       fg: foreground color
#       bg: background color
#       abg: active background color
#       justify: 'left', 'right', 'center' to justify text within the Button
#       flashrate: the rate at which the button will flash when selected in tenths of a second

# radiobutton options:
#   groupid: a string shared by all buttons in this group, unique to all groups
#   indicator: Set to 0 if no indicator is to be displayed
#   text: button text
#   server: The server name of the server referenced by this button
#   cmd: Either:
#     a text string to be sent to k4, or
#     a python 'list' object containg server name/cmd pairs (python dict objects)
#     to be sent, i.e. [ k4: k4cmd, s1: s1cmd ] would send 'k4cmd' to server k4, and
#     then send 's1cmd' to server s1.
#   fg: foreground color
#   bg: background color
#   abg: active background color
#   selectcolor: button color when selected
#   flashrate: the rate at which the button will flash when selected in tenths of a second

# slider options:
#   from: The lowest value of the slider
#   to: The highest value of he slider
#   orient: Either:
#     vertical: Specifies a vertical slider
#     horizontal: Specifies a horizontal slider
#   length: The length of the slider in pixels
#   width: The width in pixels if the slider is verical, otherwise the height
#   increment: A python expression to set the slider increment given the variable value
#   server: The server name of the server referenced by this slider
#   cmd: A python expression to produce the K4 command given the variable 'value'.
#   response: A python expression to extract the slider value from the K4 response.
#   font: The font used for the slider's text.
#   fg: foreground color
#   bg: background color

# vfo options:
#   AorB: 'A' for vfo A and 'B' for vfo B
#   fg: foreground color
#   bg: background color
#   font: the font used for the vfo
#   step_spinbox: When set to 'true', the vfo step will be selected by a spinbox

- item: defaults
  # Colors
  bg: maroon1
  abg: red
  fg: black
  # afg: black                # non-existent means same as fg
  selectcolor: red            # inherited by radiobutton

  # Font used for labels
  label_font: { family: Helvetica, size: 10, weight: normal }
  # Font used for buttons and other controls
  button_font: { family: Helvetica, size: 10, weight: normal }

- item: server
  name: k4
  type: k4
  address: K4-SNxxxxx.local      # match your serial number in the string
  port: 9200
  startup: TS1;                   # Set test mode

#- item: server
#  name: s1
#  address: 192.168.1.24
#  port: 7000

#- item: server
#  name: s2
#  address: 192.168.1.24
#  port: 7002

#- item: page
#  name: main
#  server: k4
#  columns: 2
#  row: 0
#  contains:
#    - item: group
#      columns: 1
#      contains:

- item: page
  name: main
  server: k4
  columns: 2
  row: 0
  contains:
    - item: group
      columns: 1
      contains:

      - item: group
        contains:
        - item: group
          label: VFO A
          contains:
            - { item: vfo, AorB: A, bg: white, fg: black, font: { family: Helvetica, size: 10, weight: normal } }

        - item: group
          label: VFO B
          contains:
            - { item: vfo, AorB: b, bg: white, fg: black, font: { family: Helvetica, size: 10, weight: normal } }

      - item: group
        label: S-Meter
        contains:
        - item: group
          columns: 1
          contains:
          - item: group
            contains:
            - item: group
              columns: 1
              contains:
              - item: text
                text: 'VFO A      '
                bg: white
              - item: getvalue
                cmd: SMH1;
                responsevalue: 'value if len(value) < 7 else value[3:7] + " dBm"'
                bg: white
            - item: group
              columns: 1
              contains:
              - item: group
                contains:
                - item: text
                  text: '  '
                  bg: white
                - item: bargraph
                  maximum: 42
                  length: 265
                  cmd: SM1;
                  responsevalue: 'value if len(value) < 4 else value.rstrip(";")[2:]'
                  bg: white
              - item: text
                text: " S1  3  5  7  9    +20   +40   +60"
                bg: white
          - item: group
            contains:
            - item: group
              columns: 1
              contains:
              - item: text
                text: 'VFO B      '
                bg: white
              - item: getvalue
                cmd: SMH1;
                response: SMH$;
                responsevalue: 'value if len(value) < 7 else value[4:8] + " dBm"'
                bg: white
            - item: group
              columns: 1
              contains:
              - item: group
                contains:
                - item: text
                  text: '  '
                  bg: white
                - item: bargraph
                  maximum: 42
                  length: 265
                  cmd: SM1;
                  response: SM$;
                  responsevalue: 'value if len(value) < 4 else value.rstrip(";")[3:]'
                  bg: white
              - item: text
                text: " S1  3  5  7  9    +20   +40   +60"
                bg: white

      - item: group
        contains:
        - item: cyclebutton
          wraparound: true
          updown: true
          selections:
                - { text: "+  VFO A \n  -    160 m", cmd: BN00;, abg: yellow, bg: '#CAFF70', justify: left }
                - { text: "+  VFO A \n  -     80 m", cmd: BN01;, abg: yellow, bg: '#CAFF70', justify: left }
                - { text: "+  VFO A \n  -     60 m", cmd: BN02;, abg: yellow, bg: '#CAFF70', justify: left }
                - { text: "+  VFO A \n  -     40 m", cmd: BN03;, abg: yellow, bg: '#CAFF70', justify: left }
                - { text: "+  VFO A \n  -     30 m", cmd: BN04;, abg: yellow, bg: '#CAFF70', justify: left }
                - { text: "+  VFO A \n  -     20 m", cmd: BN05;, abg: yellow, bg: '#CAFF70', justify: left }
                - { text: "+  VFO A \n  -     17 m", cmd: BN06;, abg: yellow, bg: '#CAFF70', justify: left }
                - { text: "+  VFO A \n  -     15 m", cmd: BN07;, abg: yellow, bg: '#CAFF70', justify: left }
                - { text: "+  VFO A \n  -     12 m", cmd: BN08;, abg: yellow, bg: '#CAFF70', justify: left }
                - { text: "+  VFO A \n  -     10 m", cmd: BN09;, abg: yellow, bg: '#CAFF70', justify: left }
                - { text: "+  VFO A \n  -      6 m", cmd: BN10;, abg: yellow, bg: '#CAFF70', justify: left }

        - item: cyclebutton
          wraparound: true
          updown: true
          selections:
                - { text: "+ MODE A \n   -    CW", cmd: MD3;, abg: yellow, bg: '#CAFF70', justify: left }
                - { text: "+ MODE A \n   -    USB", cmd: MD2;, abg: yellow, bg: '#CAFF70', justify: left }
                - { text: "+ MODE A \n   -    LSB", cmd: MD1;, abg: yellow, bg: '#CAFF70', justify: left }
                - { text: "+ MODE A \n   -    AM", cmd: MD5;, abg: yellow, bg: '#CAFF70', justify: left }
                - { text: "+ MODE A \n   -    FM", cmd: MD4;, abg: yellow, bg: '#CAFF70', justify: left }
                - { text: "+ MODE A \n   -    Data", cmd: MD6;, abg: yellow, bg: '#CAFF70', justify: left }

        - item: cyclebutton
          wraparound: true
          selections:
               - { text: " VFOs\n LINKED",        cmd: FT0;BI0;#DPM0;, bg: '#00C957' }
               - { text: " VFOs\n          INDY", cmd: FT0;BI1;#DPM2;, bg: 'yellow' }

        - item: group
          contains:
          - item: cyclebutton
            wraparound: true
            selections:
                - { text: "VFOs\nLOCKED",       cmd: LK1;LK$1;, bg: 'red' }  #, flashrate: 10 }
                - { text: " VFOs\nUNLOCKED  ", cmd: LK0;LK$0;, bg: '#00C957' }

      - item: group
        contains:
        - item: cyclebutton
          wraparound: true
          updown: true
          selections:
                - { text: "+  VFO B \n   -   160 m", cmd: BN$00;, abg: yellow, bg: '#98F5FF', justify: left }
                - { text: "+  VFO B \n   -    80 m", cmd: BN$01;, abg: yellow, bg: '#98F5FF', justify: left }
                - { text: "+  VFO B \n   -    60 m", cmd: BN$02;, abg: yellow, bg: '#98F5FF', justify: left }
                - { text: "+  VFO B \n   -    40 m", cmd: BN$03;, abg: yellow, bg: '#CAFF70', justify: left }
                - { text: "+  VFO B \n   -    30 m", cmd: BN$04;, abg: yellow, bg: '#98F5FF', justify: left }
                - { text: "+  VFO B \n   -    20 m", cmd: BN$05;, abg: yellow, bg: '#98F5FF', justify: left }
                - { text: "+  VFO B \n   -    17 m", cmd: BN$06;, abg: yellow, bg: '#98F5FF', justify: left }
                - { text: "+  VFO B \n   -    15 m", cmd: BN$07;, abg: yellow, bg: '#98F5FF', justify: left }
                - { text: "+  VFO B \n   -    12 m", cmd: BN$08;, abg: yellow, bg: '#98F5FF', justify: left }
                - { text: "+  VFO B \n   -    10 m", cmd: BN$09;, abg: yellow, bg: '#98F5FF', justify: left }
                - { text: "+  VFO B \n   -     6 m", cmd: BN$10;, abg: yellow, bg: '#98F5FF', justify: left }

        - item: cyclebutton
          wraparound: true
          updown: true
          selections:
                - { text: "+ MODE B \n   -      CW", cmd: MD$3;, abg: yellow, bg: '#98F5FF', justify: left }
                - { text: "+ MODE B \n   -     USB", cmd: MD$2;, abg: yellow, bg: '#98F5FF', justify: left }
                - { text: "+ MODE B \n   -     LSB", cmd: MD$1;, abg: yellow, bg: '#98F5FF', justify: left }
                - { text: "+ MODE B \n   -      AM", cmd: MD$5;, abg: yellow, bg: '#98F5FF', justify: left }
                - { text: "+ MODE B \n   -      FM", cmd: MD$4;, abg: yellow, bg: '#98F5FF', justify: left }
                - { text: "+ MODE B \n   -    DATA", cmd: MD$6;, abg: yellow, bg: '#98F5FF', justify: left }

        - item: cyclebutton
          wraparound: true
          updown: true
          selections:
                - { text: "+  Bandwidth\n  -     50 Hz",  cmd: BW0005;, abg: yellow, bg: '#CAFF70', justify: left }
                - { text: "+  Bandwidth\n  -    100 Hz",  cmd: BW0010;, abg: yellow, bg: '#CAFF70', justify: left }
                - { text: "+  Bandwidth\n  -    200 Hz",  cmd: BW0020;, abg: yellow, bg: '#CAFF70', justify: left }
                - { text: "+  Bandwidth\n  -    300 Hz",  cmd: BW0030;, abg: yellow, bg: '#CAFF70', justify: left }
                - { text: "+  Bandwidth\n  -    400 Hz",  cmd: BW0040;, abg: yellow, bg: '#CAFF70', justify: left }
                - { text: "+  Bandwidth\n  -    450 Hz",  cmd: BW0045;, abg: yellow, bg: '#CAFF70', justify: left }
                - { text: "+  Bandwidth\n  -    500 Hz",  cmd: BW0050;, abg: yellow, bg: '#CAFF70', justify: left }
                - { text: "+  Bandwidth\n  -    1.8 kHz", cmd: BW0180;, abg: yellow, bg: '#CAFF70', justify: left }
                - { text: "+  Bandwidth\n  -    2.5 kHz", cmd: BW0250;, abg: yellow, bg: '#CAFF70', justify: left }
                - { text: "+  Bandwidth\n  -    3.5 kHz", cmd: BW0350;, abg: yellow, bg: '#CAFF70', justify: left }
                - { text: "+  Bandwidth\n  -    4.0 kHz", cmd: BW0400;, abg: yellow, bg: '#CAFF70', justify: left }

        - item: group
          contains:
          - item: cyclebutton
            wraparound: true
            selections:
               - { text: "Test mode \n    on",  cmd: TS1;, bg: 'red', flashrate: 10 }
               - { text: "Test mode \n   off", cmd: TS0;, bg: '#00C957' }

      - item: group
        contains:
        - item: cyclebutton
          wraparound: true
          updown: true
          selections:
                - { text: "+    POWER \n  -       5 W", cmd: PC050L;, abg: yellow, bg: '#CAFF70', justify: left }
                - { text: "+    POWER \n  -      10 W", cmd: PC100L;, abg: yellow, bg: '#CAFF70', justify: left }
                - { text: "+    POWER \n  -      25 W", cmd: PC025H;, abg: yellow, bg: '#CAFF70', justify: left }
                - { text: "+    POWER \n  -      50 W", cmd: PC050H;, abg: yellow, bg: '#CAFF70', justify: left }
                - { text: "+    POWER \n  -      75 W", cmd: PC075H;, abg: yellow, bg: '#CAFF70', justify: left }
                - { text: "+    POWER \n  -     100 W", cmd: PC100H;, abg: yellow, bg: '#CAFF70', justify: left }

        - item: cyclebutton
          wraparound: true
          updown: true
          selections:
                - { text: "+ PREAMP \n   -       0", cmd: PA00;, abg: yellow, bg: '#CAFF70', justify: left }
                - { text: "+ PREAMP \n   -       1", cmd: PA11;, abg: yellow, bg: '#CAFF70', justify: left }
                - { text: "+ PREAMP \n   -       2", cmd: PA21;, abg: yellow, bg: '#CAFF70', justify: left }
                - { text: "+ PREAMP \n   -       3", cmd: PA31;, abg: yellow, bg: '#CAFF70', justify: left }
        - item: cyclebutton
          wraparound: true
          updown: true
          selections:
                - { text: "+ ATTEN   \n   -  0 dB", cmd: RA000;RA$000;, abg: yellow, bg: '#CAFF70', justify: left }
                - { text: "+ ATTEN   \n   -  3 dB", cmd: RA031;RA$031;, abg: yellow, bg: '#CAFF70', justify: left }
                - { text: "+ ATTEN   \n   -  6 dB", cmd: RA061;RA$061;, abg: yellow, bg: '#CAFF70', justify: left }
                - { text: "+ ATTEN   \n   - 12 dB", cmd: RA121;RA$121;, abg: yellow, bg: '#CAFF70', justify: left }
                - { text: "+ ATTEN   \n   - 15 dB", cmd: RA151;RA$151;, abg: yellow, bg: '#CAFF70', justify: left }
                - { text: "+ ATTEM   \n   - 18 dB", cmd: RA181;RA$181;, abg: yellow, bg: '#CAFF70', justify: left }

        - item: cyclebutton
          wraparound: true
          selections:
               - { text: "  RF GAIN\n -0     ", cmd: RG-00;RG$-00;, bg: '#00C957' }
               - { text: "  RF GAIN\n-10     ", cmd: RG-10;RG$-10;, bg: 'yellow' }

      - item: group
        label: Power (Watts)
        contains:
        - item: slider
          from: 0.0
          to: 110.0
          length: 300
          incrementvalue: '.0001 if value > 0.0 and value <= .01 else .1 if value <= 10.0 else 1.0'
          cmdvalue: '"PC{:03d}L;".format(int(float(value)*10)) if float(value) <= 10.0 else "PC{:03d}H;".format(int(value))'
          responsevalue: 'float(value[2:5])/10 if value[5] == "L" else float(value[2:5])/10000 if value[5] == "X" else float(value[2:5])'

      - item: group
        label: Main Volume
        contains:
        - item: slider
          from: 0
          to: 100
          length: 300
          incrementvalue: '1'
          cmdvalue: '"AG{:03d};".format(int(float(value)*0.6))'
          responsevalue: 'float(value[2:5])/0.6'
          bg: '#CAFF70'

      - item: group
        label: Sub Volume
        contains:
        - item: slider
          from: 0
          to: 100
          length: 300
          incrementvalue: '1'
          cmdvalue: '"AG${:03d};".format(int(float(value)*0.6))'
          responsevalue: 'float(value[3:6])/0.6'
          bg: '#98F5FF'

      - item: group
        label: Sidetone
        contains:
        - item: slider
          from: 0
          to: 100
          length: 300
          incrementvalue: '1'
          cmdvalue: '"ML0{:03d};".format(int(float(value)))'
          responsevalue: 'float(value[3:6])'
          bg: '#00C957'

      - item: group
        contains:
        - item: cyclebutton
          wraparound: true
          selections:
            - { text: "ATU bypass", cmd: AT1;,  abg: yellow, bg: 'red' }
            - { text: "ATU auto",   cmd: AT2;,  abg: yellow, bg: '#00C957' }
        - { item: button, groupid: atu, text: " TUNE ", cmd: SW40;, abg: red, bg: yellow }

        - item: group
          columns: 4
          contains:
            - { item: button,      groupid: misc, indicator: 0, text: " A/B ",     cmd:  SW41;,         abg: green,     bg: yellow }
            - { item: button,      groupid: misc, indicator: 0, text: " A->B ",    cmd:  DE0010;SW72;,  abg: green,     bg: yellow }
            - { item: button,      groupid: misc, indicator: 0, text: " B->A ",    cmd:  SW147;,        abg: green,     bg: yellow }

      - item: group
        contains:
          - { item: button, groupid: k4, text: '    K4 POWER OFF     ', cmd:  PS0;,          abg: red1,  bg: '#00C957' }
          - { item: button,      groupid: misc, indicator: 0, text: '   Exit    ', directive:  quit,  bg:  white, abg:       red }
